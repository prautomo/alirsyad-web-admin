var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function i(t){t.forEach(n)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let l;function a(t,e){return l||(l=document.createElement("a")),l.href=e,t===l.href}function c(t,e){return t!=t?e==e:t!==e}function u(t,e,n,o){if(t){const i=d(t,e,n,o);return t[0](i)}}function d(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}function f(t,e,n,o){if(t[2]&&o){const i=t[2](o(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|i[o];return t}return e.dirty|i}return e.dirty}function h(t,e,n,o,i,r){if(i){const s=d(e,n,o,r);t.p(s,i)}}function p(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function g(e){return e&&r(e.destroy)?e.destroy:t}const m="undefined"!=typeof window;let w=m?()=>window.performance.now():()=>Date.now(),y=m?t=>requestAnimationFrame(t):t;const v=new Set;function x(t){v.forEach(e=>{e.c(t)||(v.delete(e),e.f())}),0!==v.size&&y(x)}function b(t,e){t.appendChild(e)}function $(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function E(t){const e=z("style");return function(t,e){b(t.head||t,e)}($(t),e),e.sheet}function k(t,e,n){t.insertBefore(e,n||null)}function L(t){t.parentNode.removeChild(t)}function z(t){return document.createElement(t)}function _(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function S(t){return document.createTextNode(t)}function H(){return S(" ")}function F(){return S("")}function M(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function C(t){return function(e){return e.preventDefault(),t.call(this,e)}}function T(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function P(t){return""===t?null:+t}function j(t,e){t.value=null==e?"":e}function R(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function D(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function A(t,e,n){t.classList[n?"add":"remove"](e)}function B(t,e,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,!1,e),o}const N=new Map;let W,O=0;function X(t,e,n,o,i,r,s,l=0){const a=16.666/o;let c="{\n";for(let t=0;t<=1;t+=a){const o=e+(n-e)*r(t);c+=100*t+`%{${s(o,1-o)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${l}`,f=$(t),{stylesheet:h,rules:p}=N.get(f)||function(t,e){const n={stylesheet:E(e),rules:{}};return N.set(t,n),n}(f,t);p[d]||(p[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?g+", ":""}${d} ${o}ms linear ${i}ms 1 both`,O+=1,d}function Y(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-o.length;i&&(t.style.animation=o.join(", "),O-=i,O||y(()=>{O||(N.forEach(t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}}),N.clear())}))}function q(t){W=t}function U(){if(!W)throw new Error("Function called outside component initialization");return W}function I(t){U().$$.on_mount.push(t)}function J(){const t=U();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const i=B(e,n);o.slice().forEach(e=>{e.call(t,i)})}}}function G(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const K=[],V=[],Q=[],Z=[],tt=Promise.resolve();let et=!1;function nt(t){Q.push(t)}const ot=new Set;let it,rt=0;function st(){const t=W;do{for(;rt<K.length;){const t=K[rt];rt++,q(t),lt(t.$$)}for(q(null),K.length=0,rt=0;V.length;)V.pop()();for(let t=0;t<Q.length;t+=1){const e=Q[t];ot.has(e)||(ot.add(e),e())}Q.length=0}while(K.length);for(;Z.length;)Z.pop()();et=!1,ot.clear(),q(t)}function lt(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(nt)}}function at(t,e,n){t.dispatchEvent(B(`${e?"intro":"outro"}${n}`))}const ct=new Set;let ut;function dt(){ut={r:0,c:[],p:ut}}function ft(){ut.r||i(ut.c),ut=ut.p}function ht(t,e){t&&t.i&&(ct.delete(t),t.i(e))}function pt(t,e,n,o){if(t&&t.o){if(ct.has(t))return;ct.add(t),ut.c.push(()=>{ct.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}const gt={duration:0};function mt(n,o,s,l){let a=o(n,s),c=l?0:1,u=null,d=null,f=null;function h(){f&&Y(n,f)}function p(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function g(o){const{delay:r=0,duration:s=300,easing:l=e,tick:g=t,css:m}=a||gt,b={start:w()+r,b:o};o||(b.group=ut,ut.r+=1),u||d?d=b:(m&&(h(),f=X(n,c,o,s,r,l,m)),o&&g(0,1),u=p(b,s),nt(()=>at(n,o,"start")),function(t){let e;0===v.size&&y(x),new Promise(n=>{v.add(e={c:t,f:n})})}(t=>{if(d&&t>d.start&&(u=p(d,s),d=null,at(n,u.b,"start"),m&&(h(),f=X(n,c,u.b,u.duration,0,l,a.css))),u)if(t>=u.end)g(c=u.b,1-c),at(n,u.b,"end"),d||(u.b?h():--u.group.r||i(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;c=u.a+u.d*l(e/u.duration),g(c,1-c)}return!(!u&&!d)}))}return{run(t){r(a)?(it||(it=Promise.resolve(),it.then(()=>{it=null})),it).then(()=>{a=a(),g(t)}):g(t)},end(){h(),u=d=null}}}const wt="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function yt(t,e){pt(t,1,1,()=>{e.delete(t.key)})}function vt(t,e,n,o,i,r,s,l,a,c,u,d){let f=t.length,h=r.length,p=f;const g={};for(;p--;)g[t[p].key]=p;const m=[],w=new Map,y=new Map;for(p=h;p--;){const t=d(i,r,p),l=n(t);let a=s.get(l);a?o&&a.p(t,e):(a=c(l,t),a.c()),w.set(l,m[p]=a),l in g&&y.set(l,Math.abs(p-g[l]))}const v=new Set,x=new Set;function b(t){ht(t,1),t.m(l,u),s.set(t.key,t),u=t.first,h--}for(;f&&h;){const e=m[h-1],n=t[f-1],o=e.key,i=n.key;e===n?(u=e.first,f--,h--):w.has(i)?!s.has(o)||v.has(o)?b(e):x.has(i)?f--:y.get(o)>y.get(i)?(x.add(o),b(e)):(v.add(i),f--):(a(n,s),f--)}for(;f--;){const e=t[f];w.has(e.key)||a(e,s)}for(;h;)b(m[h-1]);return m}function xt(t){t&&t.c()}function bt(t,e,o,s){const{fragment:l,on_mount:a,on_destroy:c,after_update:u}=t.$$;l&&l.m(e,o),s||nt(()=>{const e=a.map(n).filter(r);c?c.push(...e):i(e),t.$$.on_mount=[]}),u.forEach(nt)}function $t(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Et(t,e){-1===t.$$.dirty[0]&&(K.push(t),et||(et=!0,tt.then(st)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function kt(e,n,r,s,l,a,c,u=[-1]){const d=W;q(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:l,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};c&&c(f.root);let h=!1;if(f.ctx=r?r(e,n.props||{},(t,n,...o)=>{const i=o.length?o[0]:n;return f.ctx&&l(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),h&&Et(e,t)),n}):[],f.update(),h=!0,i(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(L)}else f.fragment&&f.fragment.c();n.intro&&ht(e.$$.fragment),bt(e,n.target,n.anchor,n.customElement),st()}q(d)}class Lt{$destroy(){$t(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function zt(t){const e=t-1;return e*e*e+1}function _t(t,{delay:e=0,duration:n=400,easing:o=zt,x:i=0,y:r=0,opacity:s=0}={}){const l=getComputedStyle(t),a=+l.opacity,c="none"===l.transform?"":l.transform,u=a*(1-s);return{delay:e,duration:n,easing:o,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*r}px);\n\t\t\topacity: ${a-u*e}`}}class St extends Lt{constructor(t){super(),kt(this,t,null,null,s,{})}}function Ht(e){let n,o;return{c(){n=z("div"),o=z("canvas"),T(o,"class","max-w-full"),R(o,"width",e[1]+"px"),T(o,"width",e[1]),T(o,"height",e[2])},m(t,i){k(t,n,i),b(n,o),e[4](o)},p(t,[e]){2&e&&R(o,"width",t[1]+"px"),2&e&&T(o,"width",t[1]),4&e&&T(o,"height",t[2])},i:t,o:t,d(t){t&&L(n),e[4](null)}}}function Ft(t,e,n){let{page:o}=e;const i=J();let r,s,l;function a(){i("measure",{scale:r.clientWidth/s})}var c;return I((async function(){const t=await o,e=r.getContext("2d"),i=t.getViewport({scale:1,rotation:0});n(1,s=i.width),n(2,l=i.height),await t.render({canvasContext:e,viewport:i}).promise,a(),window.addEventListener("resize",a)})),c=()=>{window.removeEventListener("resize",a)},U().$$.on_destroy.push(c),t.$$set=t=>{"page"in t&&n(3,o=t.page)},[r,s,l,o,function(t){V[t?"unshift":"push"](()=>{r=t,n(0,r)})}]}class Mt extends Lt{constructor(t){super(),kt(this,t,Ft,Ht,s,{page:3})}}function Ct(t){let e,n;function o(o){e=o.clientX,n=o.clientY;const s=o.target;t.dispatchEvent(new CustomEvent("panstart",{detail:{x:e,y:n,target:s}})),window.addEventListener("mousemove",i),window.addEventListener("mouseup",r)}function i(o){const i=o.clientX-e,r=o.clientY-n;e=o.clientX,n=o.clientY,t.dispatchEvent(new CustomEvent("panmove",{detail:{x:e,y:n,dx:i,dy:r}}))}function r(o){e=o.clientX,n=o.clientY,t.dispatchEvent(new CustomEvent("panend",{detail:{x:e,y:n}})),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",r)}function s(o){if(o.touches.length>1)return;const i=o.touches[0];e=i.clientX,n=i.clientY;const r=i.target;t.dispatchEvent(new CustomEvent("panstart",{detail:{x:e,y:n,target:r}})),window.addEventListener("touchmove",l,{passive:!1}),window.addEventListener("touchend",a)}function l(o){if(o.preventDefault(),o.touches.length>1)return;const i=o.touches[0],r=i.clientX-e,s=i.clientY-n;e=i.clientX,n=i.clientY,t.dispatchEvent(new CustomEvent("panmove",{detail:{x:e,y:n,dx:r,dy:s}}))}function a(o){const i=o.changedTouches[0];e=i.clientX,n=i.clientY,t.dispatchEvent(new CustomEvent("panend",{detail:{x:e,y:n}})),window.removeEventListener("touchmove",l),window.removeEventListener("touchend",a)}return t.addEventListener("mousedown",o),t.addEventListener("touchstart",s),{destroy(){t.removeEventListener("mousedown",o),t.removeEventListener("touchstart",s)}}}const Tt=[{name:"pdfjsLib",src:"https://unpkg.com/pdfjs-dist@2.3.200/build/pdf.min.js"},{name:"PDFLib",src:"https://unpkg.com/pdf-lib@1.4.0/dist/pdf-lib.min.js"},{name:"download",src:"https://unpkg.com/downloadjs@1.4.7"},{name:"makeTextPDF",src:"/makeTextPDF.js"}],Pt={};function jt(t){if(Pt[t])return Pt[t];const e=Tt.find(e=>e.name===t);if(!e)throw new Error(`Script ${t} not exists.`);return Rt(e)}function Rt({name:t,src:e}){return Pt[t]||(Pt[t]=new Promise((n,o)=>{const i=document.createElement("script");i.src=e,i.onload=()=>{n(window[t]),console.log(t+" is loaded.")},i.onerror=()=>{o(`The script ${t} didn't load correctly.`),alert("Some scripts did not load correctly. Please reload and try again.")},document.body.appendChild(i)})),Pt[t]}const Dt={Courier:{correction:(t,e)=>(t*e-t)/2+t/6},Helvetica:{correction:(t,e)=>(t*e-t)/2+t/10},"Times-Roman":{correction:(t,e)=>(t*e-t)/2+t/7}},At={...Dt,"標楷體":{src:"/CK.ttf",correction:(t,e)=>(t*e-t)/2}};function Bt(t){if(Dt[t])return Dt[t];const e=At[t];if(!e)throw new Error(`Font '${t}' not exists.`);return Dt[t]=fetch(e.src).then(t=>t.arrayBuffer()).then(n=>{const o=new FontFace(t,n);return o.display="swap",o.load().then(()=>document.fonts.add(o)),{...e,buffer:n}}),Dt[t]}function Nt(t){return new Promise((e,n)=>{const o=new FileReader;o.onload=()=>e(o.result),o.onerror=n,o.readAsArrayBuffer(t)})}function Wt(e){let n,o,r,s,l,a,c,u,d;return{c(){n=z("div"),o=z("div"),o.innerHTML='<div data-direction="left" class="resize-border h-full w-1 left-0 top-0 border-l cursor-ew-resize svelte-i6z4ik"></div> \n    <div data-direction="top" class="resize-border w-full h-1 left-0 top-0 border-t cursor-ns-resize svelte-i6z4ik"></div> \n    <div data-direction="bottom" class="resize-border w-full h-1 left-0 bottom-0 border-b cursor-ns-resize svelte-i6z4ik"></div> \n    <div data-direction="right" class="resize-border h-full w-1 right-0 top-0 border-r cursor-ew-resize svelte-i6z4ik"></div> \n    <div data-direction="left-top" class="resize-corner left-0 top-0 cursor-nwse-resize transform -translate-x-1/2 -translate-y-1/2 md:scale-25 svelte-i6z4ik"></div> \n    <div data-direction="right-top" class="resize-corner right-0 top-0 cursor-nesw-resize transform translate-x-1/2 -translate-y-1/2 md:scale-25 svelte-i6z4ik"></div> \n    <div data-direction="left-bottom" class="resize-corner left-0 bottom-0 cursor-nesw-resize transform -translate-x-1/2 translate-y-1/2 md:scale-25 svelte-i6z4ik"></div> \n    <div data-direction="right-bottom" class="resize-corner right-0 bottom-0 cursor-nwse-resize transform translate-x-1/2 translate-y-1/2 md:scale-25 svelte-i6z4ik"></div>',s=H(),l=z("div"),l.innerHTML='<img class="w-full h-full" src="/delete.svg" alt="delete object"/>',a=H(),c=z("canvas"),T(o,"class","absolute w-full h-full cursor-grab svelte-i6z4ik"),A(o,"cursor-grabbing","move"===e[5]),A(o,"operation",e[5]),T(l,"class","absolute left-0 top-0 right-0 w-12 h-12 m-auto rounded-full bg-white cursor-pointer transform -translate-y-1/2 md:scale-25"),T(c,"class","w-full h-full"),T(n,"class","absolute left-0 top-0 select-none"),R(n,"width",e[0]+e[8]+"px"),R(n,"height",e[1]+e[9]+"px"),R(n,"transform","translate("+(e[2]+e[6])+"px, "+(e[3]+e[7])+"px)")},m(t,i){k(t,n,i),b(n,o),b(n,s),b(n,l),b(n,a),b(n,c),e[17](c),u||(d=[g(r=Ct.call(null,o)),M(o,"panstart",e[12]),M(o,"panmove",e[10]),M(o,"panend",e[11]),M(l,"click",e[13])],u=!0)},p(t,[e]){32&e&&A(o,"cursor-grabbing","move"===t[5]),32&e&&A(o,"operation",t[5]),257&e&&R(n,"width",t[0]+t[8]+"px"),514&e&&R(n,"height",t[1]+t[9]+"px"),204&e&&R(n,"transform","translate("+(t[2]+t[6])+"px, "+(t[3]+t[7])+"px)")},i:t,o:t,d(t){t&&L(n),e[17](null),u=!1,i(d)}}}function Ot(t,e,n){let{payload:o}=e,{file:i}=e,{width:r}=e,{height:s}=e,{x:l}=e,{y:a}=e,{pageScale:c=1}=e;const u=J();let d,f,h,p="",g=[],m=0,w=0,y=0,v=0;return I((async function(){n(4,h.width=r,h),n(4,h.height=s,h),h.getContext("2d").drawImage(o,0,0);let t=1;r>500&&(t=500/r),s>500&&(t=Math.min(t,500/s)),u("update",{width:r*t,height:s*t}),["image/jpeg","image/png"].includes(i.type)||h.toBlob(t=>{u("update",{file:t})})})),t.$$set=t=>{"payload"in t&&n(14,o=t.payload),"file"in t&&n(15,i=t.file),"width"in t&&n(0,r=t.width),"height"in t&&n(1,s=t.height),"x"in t&&n(2,l=t.x),"y"in t&&n(3,a=t.y),"pageScale"in t&&n(16,c=t.pageScale)},[r,s,l,a,h,p,m,w,y,v,function(t){const e=(t.detail.x-d)/c,o=(t.detail.y-f)/c;"move"===p?(n(6,m=e),n(7,w=o)):"scale"===p&&(g.includes("left")&&(n(6,m=e),n(8,y=-e)),g.includes("top")&&(n(7,w=o),n(9,v=-o)),g.includes("right")&&n(8,y=e),g.includes("bottom")&&n(9,v=o))},function(t){"move"===p?(u("update",{x:l+m,y:a+w}),n(6,m=0),n(7,w=0)):"scale"===p&&(u("update",{x:l+m,y:a+w,width:r+y,height:s+v}),n(6,m=0),n(7,w=0),n(8,y=0),n(9,v=0),g=[]),n(5,p="")},function(t){if(d=t.detail.x,f=t.detail.y,t.detail.target===t.currentTarget)return n(5,p="move");n(5,p="scale"),g=t.detail.target.dataset.direction.split("-")},function(){u("delete")},o,i,c,function(t){V[t?"unshift":"push"](()=>{h=t,n(4,h)})}]}class Xt extends Lt{constructor(t){super(),kt(this,t,Ot,Wt,c,{payload:14,file:15,width:0,height:1,x:2,y:3,pageScale:16})}}function Yt(t){let e,n;const o=t[2].default,i=u(o,t,t[1],null);return{c(){e=z("div"),i&&i.c()},m(o,r){k(o,e,r),i&&i.m(e,null),t[3](e),n=!0},p(t,[e]){i&&i.p&&(!n||2&e)&&h(i,o,t,t[1],n?f(o,t[1],e,null):p(t[1]),null)},i(t){n||(ht(i,t),n=!0)},o(t){pt(i,t),n=!1},d(n){n&&L(e),i&&i.d(n),t[3](null)}}}function qt(t,e,n){let o,{$$slots:i={},$$scope:r}=e;return t.$$set=t=>{"$$scope"in t&&n(1,r=t.$$scope)},t.$$.update=()=>{1&t.$$.dirty&&o&&document.body.appendChild(o)},[o,r,i,function(t){V[t?"unshift":"push"](()=>{o=t,n(0,o)})}]}class Ut extends Lt{constructor(t){super(),kt(this,t,qt,Yt,s,{})}}function It(t){let e,n;const o=t[0].default,i=u(o,t,t[1],null);return{c(){e=z("div"),i&&i.c(),T(e,"class","fixed z-10 top-0 left-0 right-0 h-12")},m(t,o){k(t,e,o),i&&i.m(e,null),n=!0},p(t,e){i&&i.p&&(!n||2&e)&&h(i,o,t,t[1],n?f(o,t[1],e,null):p(t[1]),null)},i(t){n||(ht(i,t),n=!0)},o(t){pt(i,t),n=!1},d(t){t&&L(e),i&&i.d(t)}}}function Jt(t){let e,n;return e=new Ut({props:{$$slots:{default:[It]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,o){bt(e,t,o),n=!0},p(t,[n]){const o={};2&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){$t(e,t)}}}function Gt(t,e,n){let{$$slots:o={},$$scope:i}=e;return t.$$set=t=>{"$$scope"in t&&n(1,i=t.$$scope)},[o,i]}class Kt extends Lt{constructor(t){super(),kt(this,t,Gt,Jt,s,{})}}function Vt(t){function e(e){Array.from(e.touches).some(e=>t.contains(e.target))||t.dispatchEvent(new CustomEvent("tapout"))}function n(e){t.contains(e.target)||t.dispatchEvent(new CustomEvent("tapout"))}return window.addEventListener("touchstart",e),window.addEventListener("mousedown",n),{destroy(){window.removeEventListener("touchstart",e),window.removeEventListener("mousedown",n)}}}const Qt=()=>{};function Zt(t,e,n){const o=t.slice();return o[36]=e[n],o}function te(t){let e,n;return e=new Kt({props:{$$slots:{default:[ne]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,o){bt(e,t,o),n=!0},p(t,n){const o={};56&n[0]|256&n[1]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){$t(e,t)}}}function ee(e){let n,o,i,r=e[36]+"";return{c(){n=z("option"),o=S(r),n.__value=i=e[36],n.value=n.__value},m(t,e){k(t,n,e),b(n,o)},p:t,d(t){t&&L(n)}}}function ne(t){let e,n,o,r,s,l,c,u,d,f,h,p,m,w,y,v,x,$,E,_,S,F,C,R,A,B,N=t[9],W=[];for(let e=0;e<N.length;e+=1)W[e]=ee(Zt(t,N,e));return{c(){e=z("div"),n=z("div"),o=z("img"),s=H(),l=z("input"),c=H(),u=z("div"),d=z("img"),h=H(),p=z("input"),m=H(),w=z("div"),y=z("img"),x=H(),$=z("div"),E=z("select");for(let t=0;t<W.length;t+=1)W[t].c();_=H(),S=z("div"),S.innerHTML='<svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757\n                6.586 4.343 8z"></path></svg>',F=H(),C=z("div"),C.innerHTML='<img class="w-full h-full" src="/delete.svg" alt="delete object"/>',a(o.src,r="/line_height.svg")||T(o,"src","/line_height.svg"),T(o,"class","w-6 mr-2"),T(o,"alt","Line height"),T(l,"type","number"),T(l,"min","1"),T(l,"max","10"),T(l,"step","0.1"),T(l,"class","h-6 w-12 text-center flex-shrink-0 rounded-sm"),T(n,"class","mr-2 flex items-center"),a(d.src,f="/text.svg")||T(d,"src","/text.svg"),T(d,"class","w-6 mr-2"),T(d,"alt","Font size"),T(p,"type","number"),T(p,"min","12"),T(p,"max","120"),T(p,"step","1"),T(p,"class","h-6 w-12 text-center flex-shrink-0 rounded-sm"),T(u,"class","mr-2 flex items-center"),a(y.src,v="/text-family.svg")||T(y,"src","/text-family.svg"),T(y,"class","w-4 mr-2"),T(y,"alt","Font family"),T(E,"class","font-family svelte-14i4sqe"),void 0===t[5]&&nt(()=>t[28].call(E)),T(S,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"),T($,"class","relative w-32 md:w-40"),T(w,"class","mr-2 flex items-center"),T(C,"class","w-5 h-5 rounded-full bg-white cursor-pointer"),T(e,"class","h-full flex justify-center items-center bg-gray-300 border-b border-gray-400")},m(i,r){k(i,e,r),b(e,n),b(n,o),b(n,s),b(n,l),j(l,t[4]),b(e,c),b(e,u),b(u,d),b(u,h),b(u,p),j(p,t[3]),b(e,m),b(e,w),b(w,y),b(w,x),b(w,$),b($,E);for(let t=0;t<W.length;t+=1)W[t].m(E,null);D(E,t[5]),b($,_),b($,S),b(e,F),b(e,C),A||(B=[M(l,"input",t[26]),M(p,"input",t[27]),M(E,"change",t[28]),M(E,"change",t[19]),M(C,"click",t[20]),g(R=Vt.call(null,e)),M(e,"tapout",t[18]),M(e,"mousedown",t[17]),M(e,"touchstart",t[17],{passive:!0})],A=!0)},p(t,e){if(16&e[0]&&P(l.value)!==t[4]&&j(l,t[4]),8&e[0]&&P(p.value)!==t[3]&&j(p,t[3]),512&e[0]){let n;for(N=t[9],n=0;n<N.length;n+=1){const o=Zt(t,N,n);W[n]?W[n].p(o,e):(W[n]=ee(o),W[n].c(),W[n].m(E,null))}for(;n<W.length;n+=1)W[n].d(1);W.length=N.length}544&e[0]&&D(E,t[5])},d(t){t&&L(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(W,t),A=!1,i(B)}}}function oe(t){let e,n,o,r,s,l,a,c,u,d,f=t[8]&&te(t);return{c(){f&&f.c(),e=H(),n=z("div"),o=z("div"),s=H(),l=z("div"),T(o,"class","absolute w-full h-full cursor-grab border border-dotted border-gray-500 svelte-14i4sqe"),A(o,"cursor-grab",!t[8]),A(o,"cursor-grabbing","move"===t[8]),A(o,"editing",["edit","tool"].includes(t[8])),T(l,"contenteditable","true"),T(l,"spellcheck","false"),T(l,"class","outline-none whitespace-no-wrap"),R(l,"font-size",t[3]+"px"),R(l,"font-family","'"+t[5]+"', serif"),R(l,"line-height",t[4]),R(l,"-webkit-user-select","text"),T(n,"class","absolute left-0 top-0 select-none"),R(n,"transform","translate("+(t[0]+t[6])+"px, "+(t[1]+t[7])+"px)")},m(i,h){f&&f.m(i,h),k(i,e,h),k(i,n,h),b(n,o),b(n,s),b(n,l),t[29](l),c=!0,u||(d=[g(r=Ct.call(null,o)),M(o,"panstart",t[12]),M(o,"panmove",t[10]),M(o,"panend",t[11]),M(l,"focus",t[13]),M(l,"keydown",t[16]),M(l,"paste",C(t[15])),g(a=Vt.call(null,n)),M(n,"tapout",t[14])],u=!0)},p(t,i){t[8]?f?(f.p(t,i),256&i[0]&&ht(f,1)):(f=te(t),f.c(),ht(f,1),f.m(e.parentNode,e)):f&&(dt(),pt(f,1,1,()=>{f=null}),ft()),256&i[0]&&A(o,"cursor-grab",!t[8]),256&i[0]&&A(o,"cursor-grabbing","move"===t[8]),256&i[0]&&A(o,"editing",["edit","tool"].includes(t[8])),(!c||8&i[0])&&R(l,"font-size",t[3]+"px"),(!c||32&i[0])&&R(l,"font-family","'"+t[5]+"', serif"),(!c||16&i[0])&&R(l,"line-height",t[4]),(!c||195&i[0])&&R(n,"transform","translate("+(t[0]+t[6])+"px, "+(t[1]+t[7])+"px)")},i(t){c||(ht(f),c=!0)},o(t){pt(f),c=!1},d(o){f&&f.d(o),o&&L(e),o&&L(n),t[29](null),u=!1,i(d)}}}function ie(t,e,n){let{size:o}=e,{text:i}=e,{lineHeight:r}=e,{x:s}=e,{y:l}=e,{fontFamily:a}=e,{pageScale:c=1}=e;const u=Object.keys(At),d=J();let f,h,p,g=o,m=r,w=a,y=0,v=0,x="";function b(){let t;for(;t=Array.from(p.childNodes).find(t=>!["#text","BR"].includes(t.nodeName));)p.removeChild(t)}function $(){const t=p.childNodes,e=[];let n="";for(let o=0;o<t.length;o++){const i=t[o];"BR"===i.nodeName?(e.push(n),n=""):n+=i.textContent}return e.push(n),e}return I((function(){n(2,p.innerHTML=i,p),p.focus()})),t.$$set=t=>{"size"in t&&n(21,o=t.size),"text"in t&&n(22,i=t.text),"lineHeight"in t&&n(23,r=t.lineHeight),"x"in t&&n(0,s=t.x),"y"in t&&n(1,l=t.y),"fontFamily"in t&&n(24,a=t.fontFamily),"pageScale"in t&&n(25,c=t.pageScale)},[s,l,p,g,m,w,y,v,x,u,function(t){n(6,y=(t.detail.x-f)/c),n(7,v=(t.detail.y-h)/c)},function(t){if(0===y&&0===v)return p.focus();d("update",{x:s+y,y:l+v}),n(6,y=0),n(7,v=0),n(8,x="")},function(t){f=t.detail.x,h=t.detail.y,n(8,x="move")},function(){n(8,x="edit")},async function(){"edit"===x&&"tool"!==x&&(p.blur(),b(),d("update",{lines:$(),width:p.clientWidth}),n(8,x=""))},async function(t){const e=t.clipboardData.getData("text");var n;document.execCommand("insertHTML",!1,e),await new Promise(t=>setTimeout(t,n)),b()},function(t){const e=Array.from(p.childNodes);if(13===t.keyCode){t.preventDefault();const n=window.getSelection(),o=n.focusNode,i=n.focusOffset;if(o===p)p.insertBefore(document.createElement("br"),e[i]);else if(o instanceof HTMLBRElement)p.insertBefore(document.createElement("br"),o);else if(o.textContent.length!==i)document.execCommand("insertHTML",!1,"<br>");else{let t=o.nextSibling;t?p.insertBefore(document.createElement("br"),t):(t=p.appendChild(document.createElement("br")),t=p.appendChild(document.createElement("br"))),n.collapse(t,0)}}},function(){n(8,x="tool")},async function(){"tool"===x&&"edit"!==x&&(d("update",{lines:$(),lineHeight:m,size:g,fontFamily:w}),n(8,x=""))},function(){d("selectFont",{name:w})},function(){d("delete")},o,i,r,a,c,function(){m=P(this.value),n(4,m)},function(){g=P(this.value),n(3,g)},function(){w=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(5,w),n(9,u)},function(t){V[t?"unshift":"push"](()=>{p=t,n(2,p)})}]}class re extends Lt{constructor(t){super(),kt(this,t,ie,oe,c,{size:21,text:22,lineHeight:23,x:0,y:1,fontFamily:24,pageScale:25},null,[-1,-1])}}function se(e){let n,o,r,s,l,a,c,u,d,f;return{c(){n=z("div"),o=z("div"),o.innerHTML='<div data-direction="left-top" class="absolute left-0 top-0 w-10 h-10 bg-green-400 rounded-full cursor-nwse-resize transform -translate-x-1/2 -translate-y-1/2 md:scale-25"></div> \n    <div data-direction="right-bottom" class="absolute right-0 bottom-0 w-10 h-10 bg-green-400 rounded-full cursor-nwse-resize transform translate-x-1/2 translate-y-1/2 md:scale-25"></div>',s=H(),l=z("div"),l.innerHTML='<img class="w-full h-full" src="/delete.svg" alt="delete object"/>',a=H(),c=_("svg"),u=_("path"),T(o,"class","absolute w-full h-full cursor-grab border border-gray-400 border-dashed svelte-sf1zqb"),A(o,"cursor-grabbing","move"===e[5]),A(o,"operation",e[5]),T(l,"class","absolute left-0 top-0 right-0 w-12 h-12 m-auto rounded-full bg-white cursor-pointer transform -translate-y-1/2 md:scale-25"),T(u,"stroke-width","5"),T(u,"stroke-linejoin","round"),T(u,"stroke-linecap","round"),T(u,"stroke","black"),T(u,"fill","none"),T(u,"d",e[3]),T(c,"width","100%"),T(c,"height","100%"),T(n,"class","absolute left-0 top-0 select-none"),R(n,"width",e[0]+e[8]+"px"),R(n,"height",(e[0]+e[8])/e[9]+"px"),R(n,"transform","translate("+(e[1]+e[6])+"px, "+(e[2]+e[7])+"px)")},m(t,i){k(t,n,i),b(n,o),b(n,s),b(n,l),b(n,a),b(n,c),b(c,u),e[17](c),d||(f=[g(r=Ct.call(null,o)),M(o,"panstart",e[12]),M(o,"panmove",e[10]),M(o,"panend",e[11]),M(l,"click",e[13])],d=!0)},p(t,[e]){32&e&&A(o,"cursor-grabbing","move"===t[5]),32&e&&A(o,"operation",t[5]),8&e&&T(u,"d",t[3]),257&e&&R(n,"width",t[0]+t[8]+"px"),257&e&&R(n,"height",(t[0]+t[8])/t[9]+"px"),198&e&&R(n,"transform","translate("+(t[1]+t[6])+"px, "+(t[2]+t[7])+"px)")},i:t,o:t,d(t){t&&L(n),e[17](null),d=!1,i(f)}}}function le(t,e,n){let{originWidth:o}=e,{originHeight:i}=e,{width:r}=e,{x:s}=e,{y:l}=e,{pageScale:a=1}=e,{path:c}=e;const u=J();let d,f,h,p="",g=0,m=0,w=0,y="";const v=o/i;return I((async function(){h.setAttribute("viewBox",`0 0 ${o} ${i}`)})),t.$$set=t=>{"originWidth"in t&&n(14,o=t.originWidth),"originHeight"in t&&n(15,i=t.originHeight),"width"in t&&n(0,r=t.width),"x"in t&&n(1,s=t.x),"y"in t&&n(2,l=t.y),"pageScale"in t&&n(16,a=t.pageScale),"path"in t&&n(3,c=t.path)},[r,s,l,c,h,p,g,m,w,v,function(t){const e=(t.detail.x-d)/a,o=(t.detail.y-f)/a;if("move"===p)n(6,g=e),n(7,m=o);else if("scale"===p){if("left-top"===y){let t=1/0;t=Math.min(e,o*v),n(6,g=t),n(8,w=-t),n(7,m=t/v)}if("right-bottom"===y){let t=-1/0;t=Math.max(e,o*v),n(8,w=t)}}},function(t){"move"===p?(u("update",{x:s+g,y:l+m}),n(6,g=0),n(7,m=0)):"scale"===p&&(u("update",{x:s+g,y:l+m,width:r+w,scale:(r+w)/o}),n(6,g=0),n(7,m=0),n(8,w=0),y=""),n(5,p="")},function(t){if(d=t.detail.x,f=t.detail.y,t.detail.target===t.currentTarget)return n(5,p="move");n(5,p="scale"),y=t.detail.target.dataset.direction},function(){u("delete")},o,i,a,function(t){V[t?"unshift":"push"](()=>{h=t,n(4,h)})}]}class ae extends Lt{constructor(t){super(),kt(this,t,le,se,c,{originWidth:14,originHeight:15,width:0,x:1,y:2,pageScale:16,path:3})}}function ce(e){let n,o,r,s,l,a,c,u,d,f,h;return{c(){n=z("div"),o=z("div"),r=z("button"),r.textContent="Cancel",s=H(),l=z("button"),l.textContent="Done",a=H(),c=_("svg"),u=_("path"),T(r,"class","w-24 bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded mr-4"),T(l,"class","w-24 bg-blue-600 hover:bg-blue-700 text-white font-bold py-1 px-4 rounded"),T(o,"class","absolute right-0 bottom-0 mr-4 mb-4 flex"),T(u,"stroke-width","5"),T(u,"stroke-linejoin","round"),T(u,"stroke-linecap","round"),T(u,"d",e[1]),T(u,"stroke","black"),T(u,"fill","none"),T(c,"class","w-full h-full pointer-events-none"),T(n,"class","relative w-full h-full select-none")},m(t,i){k(t,n,i),b(n,o),b(o,r),b(o,s),b(o,l),b(n,a),b(n,c),b(c,u),e[7](n),f||(h=[M(r,"click",e[6]),M(l,"click",e[5]),g(d=Ct.call(null,n)),M(n,"panstart",e[2]),M(n,"panmove",e[3]),M(n,"panend",e[4])],f=!0)},p(t,[e]){2&e&&T(u,"d",t[1])},i:t,o:t,d(t){t&&L(n),e[7](null),f=!1,i(h)}}}function ue(t,e,n){const o=J();let i,r=0,s=0,l="",a=1/0,c=0,u=1/0,d=0,f=[],h=!1;return[i,l,function(t){if(t.detail.target!==i)return h=!1;h=!0,r=t.detail.x,s=t.detail.y,a=Math.min(a,r),c=Math.max(c,r),u=Math.min(u,s),d=Math.max(d,s),f.push(["M",r,s]),n(1,l+=`M${r},${s}`)},function(t){h&&(r=t.detail.x,s=t.detail.y,a=Math.min(a,r),c=Math.max(c,r),u=Math.min(u,s),d=Math.max(d,s),f.push(["L",r,s]),n(1,l+=`L${r},${s}`))},function(){h=!1},function(){if(!f.length)return;const t=-(a-10),e=-(u-10);o("finish",{originWidth:c-a+20,originHeight:d-u+20,path:f.reduce((n,o)=>n+o[0]+(o[1]+t)+","+(o[2]+e),"")})},function(){o("cancel")},function(t){V[t?"unshift":"push"](()=>{i=t,n(0,i)})}]}class de extends Lt{constructor(t){super(),kt(this,t,ue,ce,s,{})}}const{window:fe}=wt;function he(t,e,n){const o=t.slice();return o[42]=e[n],o[44]=n,o}function pe(t,e,n){const o=t.slice();return o[45]=e[n],o}function ge(e){let n,o,i,r;return o=new de({}),o.$on("finish",e[22]),o.$on("cancel",e[23]),{c(){n=z("div"),xt(o.$$.fragment),T(n,"class","fixed z-10 top-0 left-0 right-0 border-b border-gray-300 bg-white shadow-lg"),R(n,"height","50%")},m(t,e){k(t,n,e),bt(o,n,null),r=!0},p:t,i(t){r||(ht(o.$$.fragment,t),nt(()=>{i||(i=mt(n,_t,{y:-200,duration:500},!0)),i.run(1)}),r=!0)},o(t){pt(o.$$.fragment,t),i||(i=mt(n,_t,{y:-200,duration:500},!1)),i.run(0),r=!1},d(t){t&&L(n),$t(o),t&&i&&i.end()}}}function me(e){let n;return{c(){n=z("div"),n.innerHTML='<span class="font-bold text-3xl text-gray-500">Drag something here</span>',T(n,"class","w-full flex-grow flex justify-center items-center")},m(t,e){k(t,n,e)},p:t,i:t,o:t,d(t){t&&L(n)}}}function we(t){let e,n,o,i,r,s,l,c,u,d,f=[],h=new Map,p=t[2];const g=t=>t[42];for(let e=0;e<p.length;e+=1){let n=he(t,p,e),o=g(n);h.set(o,f[e]=$e(o,n))}return{c(){e=z("div"),n=z("img"),i=H(),r=z("input"),s=H(),l=z("div");for(let t=0;t<f.length;t+=1)f[t].c();a(n.src,o="/edit.svg")||T(n,"src","/edit.svg"),T(n,"class","mr-2"),T(n,"alt","a pen, edit pdf name"),T(r,"placeholder","Rename your PDF here"),T(r,"type","text"),T(r,"class","flex-grow bg-transparent"),T(e,"class","flex justify-center px-5 w-full md:hidden"),T(l,"class","w-full")},m(o,a){k(o,e,a),b(e,n),b(e,i),b(e,r),j(r,t[1]),k(o,s,a),k(o,l,a);for(let t=0;t<f.length;t+=1)f[t].m(l,null);c=!0,u||(d=M(r,"input",t[24]),u=!0)},p(t,e){2&e[0]&&r.value!==t[1]&&j(r,t[1]),254012&e[0]&&(p=t[2],dt(),f=vt(f,e,g,1,t,p,h,l,yt,$e,null,he),ft())},i(t){if(!c){for(let t=0;t<p.length;t+=1)ht(f[t]);c=!0}},o(t){for(let t=0;t<f.length;t+=1)pt(f[t]);c=!1},d(t){t&&L(e),t&&L(s),t&&L(l);for(let t=0;t<f.length;t+=1)f[t].d();u=!1,d()}}}function ye(t){let e,n;return e=new ae({props:{path:t[45].path,x:t[45].x,y:t[45].y,width:t[45].width,originWidth:t[45].originWidth,originHeight:t[45].originHeight,pageScale:t[3][t[44]]}}),e.$on("update",(function(...e){return t[30](t[45],...e)})),e.$on("delete",(function(){return t[31](t[45])})),{c(){xt(e.$$.fragment)},m(t,o){bt(e,t,o),n=!0},p(n,o){t=n;const i={};20&o[0]&&(i.path=t[45].path),20&o[0]&&(i.x=t[45].x),20&o[0]&&(i.y=t[45].y),20&o[0]&&(i.width=t[45].width),20&o[0]&&(i.originWidth=t[45].originWidth),20&o[0]&&(i.originHeight=t[45].originHeight),12&o[0]&&(i.pageScale=t[3][t[44]]),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){$t(e,t)}}}function ve(t){let e,n;return e=new re({props:{text:t[45].text,x:t[45].x,y:t[45].y,size:t[45].size,lineHeight:t[45].lineHeight,fontFamily:t[45].fontFamily,pageScale:t[3][t[44]]}}),e.$on("update",(function(...e){return t[28](t[45],...e)})),e.$on("delete",(function(){return t[29](t[45])})),e.$on("selectFont",t[13]),{c(){xt(e.$$.fragment)},m(t,o){bt(e,t,o),n=!0},p(n,o){t=n;const i={};20&o[0]&&(i.text=t[45].text),20&o[0]&&(i.x=t[45].x),20&o[0]&&(i.y=t[45].y),20&o[0]&&(i.size=t[45].size),20&o[0]&&(i.lineHeight=t[45].lineHeight),20&o[0]&&(i.fontFamily=t[45].fontFamily),12&o[0]&&(i.pageScale=t[3][t[44]]),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){$t(e,t)}}}function xe(t){let e,n;return e=new Xt({props:{file:t[45].file,payload:t[45].payload,x:t[45].x,y:t[45].y,width:t[45].width,height:t[45].height,pageScale:t[3][t[44]]}}),e.$on("update",(function(...e){return t[26](t[45],...e)})),e.$on("delete",(function(){return t[27](t[45])})),{c(){xt(e.$$.fragment)},m(t,o){bt(e,t,o),n=!0},p(n,o){t=n;const i={};20&o[0]&&(i.file=t[45].file),20&o[0]&&(i.payload=t[45].payload),20&o[0]&&(i.x=t[45].x),20&o[0]&&(i.y=t[45].y),20&o[0]&&(i.width=t[45].width),20&o[0]&&(i.height=t[45].height),12&o[0]&&(i.pageScale=t[3][t[44]]),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){$t(e,t)}}}function be(t,e){let n,o,i,r,s;const l=[xe,ve,ye],a=[];function c(t,e){return"image"===t[45].type?0:"text"===t[45].type?1:"drawing"===t[45].type?2:-1}return~(o=c(e))&&(i=a[o]=l[o](e)),{key:t,first:null,c(){n=F(),i&&i.c(),r=F(),this.first=n},m(t,e){k(t,n,e),~o&&a[o].m(t,e),k(t,r,e),s=!0},p(t,n){let s=o;o=c(e=t),o===s?~o&&a[o].p(e,n):(i&&(dt(),pt(a[s],1,1,()=>{a[s]=null}),ft()),~o?(i=a[o],i?i.p(e,n):(i=a[o]=l[o](e),i.c()),ht(i,1),i.m(r.parentNode,r)):i=null)},i(t){s||(ht(i),s=!0)},o(t){pt(i),s=!1},d(t){t&&L(n),~o&&a[o].d(t),t&&L(r)}}}function $e(t,e){let n,o,r,s,l,a,c,u,d,f=[],h=new Map;r=new Mt({props:{page:e[42]}}),r.$on("measure",(function(...t){return e[25](e[44],...t)}));let p=e[4][e[44]];const g=t=>t[45].id;for(let t=0;t<p.length;t+=1){let n=pe(e,p,t),o=g(n);h.set(o,f[t]=be(o,n))}function m(){return e[32](e[44])}function w(){return e[33](e[44])}return{key:t,first:null,c(){n=z("div"),o=z("div"),xt(r.$$.fragment),s=H(),l=z("div");for(let t=0;t<f.length;t+=1)f[t].c();a=H(),T(l,"class","absolute top-0 left-0 transform origin-top-left"),R(l,"transform","scale("+e[3][e[44]]+")"),R(l,"touch-action","none"),T(o,"class","relative shadow-lg"),A(o,"shadow-outline",e[44]===e[5]),T(n,"class","p-5 w-full flex flex-col items-center overflow-hidden"),this.first=n},m(t,e){k(t,n,e),b(n,o),bt(r,o,null),b(o,s),b(o,l);for(let t=0;t<f.length;t+=1)f[t].m(l,null);b(n,a),c=!0,u||(d=[M(n,"mousedown",m),M(n,"touchstart",w,{passive:!0})],u=!0)},p(t,n){e=t;const i={};4&n[0]&&(i.page=e[42]),r.$set(i),106524&n[0]&&(p=e[4][e[44]],dt(),f=vt(f,n,g,1,e,p,h,l,yt,be,null,pe),ft()),(!c||12&n[0])&&R(l,"transform","scale("+e[3][e[44]]+")"),36&n[0]&&A(o,"shadow-outline",e[44]===e[5])},i(t){if(!c){ht(r.$$.fragment,t);for(let t=0;t<p.length;t+=1)ht(f[t]);c=!0}},o(t){pt(r.$$.fragment,t);for(let t=0;t<f.length;t+=1)pt(f[t]);c=!1},d(t){t&&L(n),$t(r);for(let t=0;t<f.length;t+=1)f[t].d();u=!1,i(d)}}}function Ee(t){let e,n,o,r,s,l,c,u,d,f,h,p,g,m,w,y,v,x,$,E,_,F,P,R,D,B,N,W,O=t[6]?"Saving":"Save";e=new St({});let X=t[7]&&ge(t);const Y=[we,me],q=[];function U(t,e){return t[2].length?0:1}return R=U(t),D=q[R]=Y[R](t),{c(){xt(e.$$.fragment),n=H(),o=z("main"),r=z("div"),s=z("input"),l=H(),c=z("div"),u=z("label"),u.innerHTML='<img src="image.svg" alt="An icon for adding images"/>',d=H(),f=z("label"),f.innerHTML='<img src="notes.svg" alt="An icon for adding text"/>',h=H(),p=z("label"),p.innerHTML='<img src="gesture.svg" alt="An icon for adding drawing"/>',g=H(),m=z("div"),w=z("img"),v=H(),x=z("input"),$=H(),E=z("button"),_=S(O),F=H(),X&&X.c(),P=H(),D.c(),T(s,"type","file"),T(s,"id","image"),T(s,"name","image"),T(s,"class","hidden"),T(u,"class","flex items-center justify-center h-full w-8 hover:bg-gray-500 cursor-pointer"),T(u,"for","image"),A(u,"cursor-not-allowed",t[5]<0),A(u,"bg-gray-500",t[5]<0),T(f,"class","flex items-center justify-center h-full w-8 hover:bg-gray-500 cursor-pointer"),T(f,"for","text"),A(f,"cursor-not-allowed",t[5]<0),A(f,"bg-gray-500",t[5]<0),T(p,"class","flex items-center justify-center h-full w-8 hover:bg-gray-500 cursor-pointer"),A(p,"cursor-not-allowed",t[5]<0),A(p,"bg-gray-500",t[5]<0),T(c,"class","relative mr-3 flex h-8 bg-gray-400 rounded-sm overflow-hidden md:mr-4"),a(w.src,y="/edit.svg")||T(w,"src","/edit.svg"),T(w,"class","mr-2"),T(w,"alt","a pen, edit pdf name"),T(x,"placeholder","Rename your PDF here"),T(x,"type","text"),T(x,"class","flex-grow bg-transparent"),T(m,"class","justify-center mr-3 md:mr-4 w-full max-w-xs hidden md:flex"),T(E,"class","w-20 bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 md:px-4 mr-3 md:mr-4 rounded"),A(E,"cursor-not-allowed",0===t[2].length||t[6]||!t[0]),A(E,"bg-blue-700",0===t[2].length||t[6]||!t[0]),T(r,"class","fixed z-10 top-0 left-0 right-0 h-12 flex justify-center items-center bg-gray-200 border-b border-gray-300"),T(o,"class","flex flex-col items-center py-16 bg-gray-100 min-h-screen")},m(i,a){bt(e,i,a),k(i,n,a),k(i,o,a),b(o,r),b(r,s),b(r,l),b(r,c),b(c,u),b(c,d),b(c,f),b(c,h),b(c,p),b(r,g),b(r,m),b(m,w),b(m,v),b(m,x),j(x,t[1]),b(r,$),b(r,E),b(E,_),b(o,F),X&&X.m(o,null),b(o,P),q[R].m(o,null),B=!0,N||(W=[M(fe,"dragenter",C(t[19])),M(fe,"dragover",C(t[20])),M(fe,"drop",C(t[8])),M(s,"change",t[9]),M(f,"click",t[10]),M(p,"click",t[11]),M(x,"input",t[21]),M(E,"click",t[18])],N=!0)},p(t,e){32&e[0]&&A(u,"cursor-not-allowed",t[5]<0),32&e[0]&&A(u,"bg-gray-500",t[5]<0),32&e[0]&&A(f,"cursor-not-allowed",t[5]<0),32&e[0]&&A(f,"bg-gray-500",t[5]<0),32&e[0]&&A(p,"cursor-not-allowed",t[5]<0),32&e[0]&&A(p,"bg-gray-500",t[5]<0),2&e[0]&&x.value!==t[1]&&j(x,t[1]),(!B||64&e[0])&&O!==(O=t[6]?"Saving":"Save")&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(_,O),69&e[0]&&A(E,"cursor-not-allowed",0===t[2].length||t[6]||!t[0]),69&e[0]&&A(E,"bg-blue-700",0===t[2].length||t[6]||!t[0]),t[7]?X?(X.p(t,e),128&e[0]&&ht(X,1)):(X=ge(t),X.c(),ht(X,1),X.m(o,P)):X&&(dt(),pt(X,1,1,()=>{X=null}),ft());let n=R;R=U(t),R===n?q[R].p(t,e):(dt(),pt(q[n],1,1,()=>{q[n]=null}),ft(),D=q[R],D?D.p(t,e):(D=q[R]=Y[R](t),D.c()),ht(D,1),D.m(o,null))},i(t){B||(ht(e.$$.fragment,t),ht(X),ht(D),B=!0)},o(t){pt(e.$$.fragment,t),pt(X),pt(D),B=!1},d(t){$t(e,t),t&&L(n),t&&L(o),X&&X.d(),q[R].d(),N=!1,i(W)}}}function ke(t,e,n){const o=function(){let t=0;return function(){return t++}}();let i,r="",s=[],l=[],a=[],c="Times-Roman",u=-1,d=!1,f=!1,h="",p="",g="";async function m(t){try{const e=await async function(t){const e=await jt("pdfjsLib"),n=new Blob([t]),o=window.URL.createObjectURL(n);return e.getDocument(o).promise}(t);n(1,r=t.name),n(0,i=t);const o=e.numPages;n(2,s=Array(o).fill().map((t,n)=>e.getPage(n+1))),n(4,a=s.map(()=>[])),n(3,l=Array(o).fill(1))}catch(t){throw console.log("Failed to add pdf."),t}}function w(t,e,i,r=1){const s={id:o(),path:i,type:"drawing",x:0,y:0,originWidth:t,originHeight:e,width:t*r,scale:r};n(4,a=a.map((t,e)=>e===u?[...t,s]:t))}function y(t){n(5,u=t)}function v(t,e){n(4,a=a.map((n,o)=>o==u?n.map(n=>n.id===t?{...n,...e}:n):n))}function x(t){n(4,a=a.map((e,n)=>n==u?e.filter(e=>e.id!==t):e))}function b(t,e){n(3,l[e]=t,l)}I(async()=>{try{const t=new URLSearchParams(window.location.search);h=t.has("user_id")?t.get("user_id"):"",p=t.has("modul_id")?t.get("modul_id"):"",g=t.has("pdf_path")?t.get("pdf_path"):"";const e=t.has("url"),o=""+t.get("url");console.log("URL: ",o);const i=e?await fetch(""+o):await fetch("/test.pdf"),r=await i.blob();await m(r),n(5,u=0),setTimeout(()=>{Bt(c),Tt.forEach(Rt)},5e3),console.log("E")}catch(t){console.log(t)}});return[i,r,s,l,a,u,d,f,async function(t){const e=(t.target.files||t.dataTransfer&&t.dataTransfer.files)[0];if(e&&"application/pdf"===e.type){n(5,u=-1);try{await m(e),n(5,u=0)}catch(t){console.log(t)}}},async function(t){const e=t.target.files[0];e&&u>=0&&async function(t){try{const i=await function(t){return new Promise((e,n)=>{const o=new FileReader;o.onload=()=>e(o.result),o.onerror=n,o.readAsDataURL(t)})}(t),r=await(e=i,new Promise((t,n)=>{const o=new Image;if(o.onload=()=>t(o),o.onerror=n,e instanceof Blob){const t=window.URL.createObjectURL(e);o.src=t}else o.src=e})),s=o(),{width:l,height:c}=r,d={id:s,type:"image",width:l,height:c,x:0,y:0,payload:r,file:t};n(4,a=a.map((t,e)=>e===u?[...t,d]:t))}catch(t){console.log("Fail to add image.",t)}var e}(e),t.target.value=null},function(){u>=0&&function(t="New Text Field"){const e=o();Bt(c);const i={id:e,text:t,type:"text",size:16,width:0,lineHeight:1.4,fontFamily:c,x:0,y:0};n(4,a=a.map((t,e)=>e===u?[...t,i]:t))}()},function(){u>=0&&n(7,f=!0)},w,function(t){const e=t.detail.name;Bt(e),c=e},y,v,x,b,async function(){if(i&&!d&&s.length){n(6,d=!0);try{const r=await async function(t,e,n){const o=await jt("PDFLib"),i=(await jt("download"),await jt("makeTextPDF"));let r;try{r=await o.PDFDocument.load(await Nt(t))}catch(t){throw console.log("Failed to load PDF."),t}const s=r.getPages().map(async(t,n)=>{const s=e[n],l=t.getHeight(),a=s.map(async e=>{if("image"===e.type){let n,{file:o,x:i,y:s,width:a,height:c}=e;try{return n="image/jpeg"===o.type?await r.embedJpg(await Nt(o)):await r.embedPng(await Nt(o)),()=>t.drawImage(n,{x:i,y:l-s-c,width:a,height:c})}catch(t){return console.log("Failed to embed image.",t),Qt}}else{if("text"===e.type){let{x:n,y:o,lines:s,lineHeight:a,size:c,fontFamily:u,width:d}=e;const f=c*a*s.length,h=await Bt(u),[p]=await r.embedPdf(await i({lines:s,fontSize:c,lineHeight:a,width:d,height:f,font:h.buffer||u,dy:h.correction(c,a)}));return()=>t.drawPage(p,{width:d,height:f,x:n,y:l-o-f})}if("drawing"===e.type){let{x:n,y:i,path:r,scale:s}=e;const{pushGraphicsState:a,setLineCap:c,popGraphicsState:u,setLineJoin:d,LineCapStyle:f,LineJoinStyle:h}=o;return()=>{t.pushOperators(a(),c(f.Round),d(h.Round)),t.drawSvgPath(r,{borderWidth:5,scale:s,x:n,y:l-i}),t.pushOperators(u())}}}});(await Promise.all(a)).forEach(t=>t())});await Promise.all(s);try{return await r.save()}catch(t){throw console.log("Failed to save PDF."),t}}(i,a,0);var t=new FormData,e=new Blob([r],{type:"application/pdf"});t.append("modul",e),t.append("user_id",h),t.append("modul_id",p),t.append("pdf_path",g);var o=new XMLHttpRequest;o.open("POST","/api/moduls/upload"),o.send(t),console.log("Store to server success!")}catch(t){console.log(t)}finally{n(6,d=!1)}}},function(e){G.call(this,t,e)},function(e){G.call(this,t,e)},function(){r=this.value,n(1,r)},t=>{const{originWidth:e,originHeight:o,path:i}=t.detail;let r=1;e>500&&(r=500/e),w(e,o,i,r),n(7,f=!1)},()=>n(7,f=!1),function(){r=this.value,n(1,r)},(t,e)=>b(e.detail.scale,t),(t,e)=>v(t.id,e.detail),t=>x(t.id),(t,e)=>v(t.id,e.detail),t=>x(t.id),(t,e)=>v(t.id,e.detail),t=>x(t.id),t=>y(t),t=>y(t)]}jt("pdfjsLib");return new class extends Lt{constructor(t){super(),kt(this,t,ke,Ee,s,{},null,[-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
